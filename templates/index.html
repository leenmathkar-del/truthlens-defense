<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TruthLens Defense</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="container">

    <h1>TRUTHLENS DEFENSE</h1>
    <p class="subtitle">Adaptive Cyber Intelligence Platform</p>

    <div class="card">

        <p>Upload image for AI authenticity verification</p>

        <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ -->
        <form id="scanForm" enctype="multipart/form-data">
            <input type="file" name="image" id="imageInput" required>
            <button type="submit">ðŸ›° Scan Image</button>
        </form>

        <!-- Ø´Ø±ÙŠØ· ØªÙ‚Ø¯Ù… -->
        <div id="progressBar" style="display:none; margin-top:15px;">
            <div style="background:#222; border-radius:10px;">
                <div id="progress" style="width:0%; height:10px; background:#00ff88; border-radius:10px;"></div>
            </div>
        </div>

        <!-- Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ -->
        <div id="resultBox" style="margin-top:20px; display:none;">
            <h3>Analysis Result</h3>
            <p id="confidence"></p>
            <p id="threatLevel"></p>
        </div>

    </div>

</div>

<script>
const form = document.getElementById("scanForm");
const progressBar = document.getElementById("progressBar");
const progress = document.getElementById("progress");
const resultBox = document.getElementById("resultBox");
const confidenceText = document.getElementById("confidence");
const threatText = document.getElementById("threatLevel");

form.addEventListener("submit", async function(e){
    e.preventDefault();

    const formData = new FormData(form);

    progressBar.style.display = "block";
    resultBox.style.display = "none";
    progress.style.width = "10%";

    let fakeProgress = 10;
    const interval = setInterval(()=>{
        if(fakeProgress < 90){
            fakeProgress += 10;
            progress.style.width = fakeProgress + "%";
        }
    }, 200);

    const response = await fetch("/analyze_image", {
        method: "POST",
        body: formData
    });

    const data = await response.json();

    clearInterval(interval);
    progress.style.width = "100%";

    setTimeout(()=>{
        progressBar.style.display = "none";
        resultBox.style.display = "block";

        if(data.status === "success"){
            confidenceText.innerHTML = "Confidence Score: " + data.confidence;
            threatText.innerHTML = "Threat Level: " + data.threat_level;
        } else {
            confidenceText.innerHTML = "Error occurred";
            threatText.innerHTML = "";
        }

    }, 500);
});
</script>

</body>
</html>
